#To copy the committed code from CodeCommit and upload it to an S3 bucket under a specific folder,

#In this example, each file will be uploaded to the your-folder folder in the S3 bucket. Update the Bucket parameter with the name of your S3 bucket, and the Key 
#parameter with the desired folder path, which will be created by concatenating the file['path'] and 'your-folder/'. 
#The rest of the steps to set up the Lambda function are the same as in the previous answer.

import boto3

def lambda_handler(event, context):
    codecommit = boto3.client('codecommit')
    s3 = boto3.client('s3')
    
    # Get the repository and commit ID from the event
    repository_name = event['repositoryName']
    commit_id = event['references'][0]['commit']
    
    # Get the latest code from the CodeCommit repository
    response = codecommit.get_commit(
        repositoryName=repository_name,
        commitId=commit_id
    )
    file_contents = response['commit']['tree']['blobs']
    
    # Upload each file to the specified S3 bucket
    for file in file_contents:
        file_response = codecommit.get_blob(
            repositoryName=repository_name,
            blobId=file['blobId']
        )
        file_data = file_response['content']
        s3.put_object(
            Body=file_data,
            Bucket='your-bucket-name',
            Key='your-folder/' + file['path']
        )
